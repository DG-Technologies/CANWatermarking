<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>CAN Conditioner Devices</title>
</head>
<body>
    <div id="authTokenModal" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="authToken">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                    <h4 class="modal-title" id="myModalLabel">Your Auth Token</h4>
                </div>
                <div class="modal-body">
                    <textarea class="authToken" id='authToken'></textarea>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>
    <a href="signin.html">Sign in.</a>

    <script src="js/vendor/jquery-3.1.0.js"></script>
    <script src="js/vendor/aws-cognito-sdk.min.js"></script>
    <script src="js/vendor/amazon-cognito-identity.min.js"></script>
    <script src="js/config.js"></script>
    <script src="js/cognito-auth.js"></script>
    <script>
        $(document).ready( function(){
            const urlParams = new URLSearchParams(window.location.hash);
            authable = urlParams.get('#id_token');
            console.log("authToken: ");
            console.log(authable);
            $("#authToken").val(authable);
            $.ajax({
                url: "https://jeg5qkwei4.execute-api.us-east-1.amazonaws.com/dev/list_keys",
                method: "GET",
                crossDomain: true,
                dataType: 'json',
                headers: {
                    'Authorization': "Bearer " + authable,
                    
                }
            })
            .done( function(data){
                console.log(data);
            })

        });
            
    </script>
</body>

</html>
